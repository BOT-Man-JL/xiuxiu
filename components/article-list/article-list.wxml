<!--article-list.wxml-->

<!--æ¯ä¸€æ¡å†…å®¹-->
<view class="list-container {{ popupState ? '' : 'masking' }}">
  <view wx:for="{{ articleList }}" wx:key="id" class="list-item">
    <!--ä½œè€…å¤´åƒ-->
    <view class="avatar">
      <image src="{{ item.metaData.authorAvatar }}" bindtap="promptUnsupported" data-text="æš‚æœªå¼€æ”¾æ­¤åŠŸèƒ½ ðŸ™ƒ" mode="aspectFill" />
    </view>

    <!--å³è¾¹çš„éƒ¨åˆ†-->
    <view class="list-item-right">
      <!--å³è¾¹çš„å‘å¸ƒè€…ä¿¡æ¯-->
      <view class="list-item-header">
        <!--ä½œè€…åç§°-->
        <view class="item-author-text">
          <text bindtap="promptUnsupported" data-text="æš‚æœªå¼€æ”¾æ­¤åŠŸèƒ½ ðŸ™ƒ">{{ item.metaData.authorName }}</text>
        </view>
        <!--æ—¶é—´æˆ³ + ä½ç½®/åœˆå­-->
        <view class="list-item-detail">
          <text class="list-item-text">{{ item.metaData.timestamp }}</text>
          <view wx:if="{{ item.metaData.circle }}" class="location-container" bindtap="navigateToCircleDetail" data-id="{{ item.metaData.circleId }}">
            <image class="location-icon" src="/resources/home/circle-blue.png" />
            <text class="list-item-text blue-text">{{ item.metaData.circle }}</text>
          </view>
          <view wx:else class="location-container">
            <image class="location-icon" src="/resources/home/location-gray.png" />
            <text class="list-item-text">{{ item.metaData.location }}</text>
          </view>
        </view>

        <!--å³è¾¹å‘å¸ƒçš„å†…å®¹-->
        <view class="list-item-data-container">
          <!-- æ–‡æœ¬ -->
          <view wx:if="{{ item.articleData.text }}" class="list-item-main-text">
            <text>{{ item.articleData.text }}</text>
          </view>

          <!-- å›¾ç‰‡ -->
          <view wx:if="{{ item.articleType == 'picture' }}" class="large-image-item">
            <image src="{{ item.articleData.picture.src }}" bindtap="viewBigImage" data-src="{{ item.articleData.picture.src }}" mode="widthFix" />
          </view>

          <!-- å›¾é›† -->
          <view wx:if="{{ item.articleType == 'pictures' }}" class="image-album">
            <image wx:for="{{ item.articleData.pictures }}" wx:for-item="picture" wx:key="url" src="{{ picture.src }}" bindtap="viewBigImage" data-src="{{ picture.src }}" mode="aspectFill" />
          </view>

          <!-- è§†é¢‘ -->
          <!-- <view wx:if="{{ item.articleType == 'video' }}" class="video-item">
            <video src="{{ item.articleData.video.src }}" poster="{{ item.articleData.video.poster }}" />
          </view> -->
          <view wx:if="{{ item.articleType == 'video' }}" class="large-image-item">
            <image src="{{ item.articleData.video.poster }}" bindtap="promptUnsupported" data-text="ç”±äºŽå¾®ä¿¡é™åˆ¶ï¼Œæš‚ä¸æ”¯æŒè§†é¢‘æ’­æ”¾åŠŸèƒ½ ðŸ˜”" mode="widthFix" />
          </view>

          <!-- å¤–é“¾ -->
          <view wx:if="{{ item.articleType == 'link' }}" class="link-item" bindtap="promptUnsupported" data-text="ç”±äºŽå¾®ä¿¡é™åˆ¶ï¼Œæš‚ä¸æ”¯æŒæ‰“å¼€å¤–é“¾åŠŸèƒ½ ðŸ˜”">
            <image src="{{ item.articleData.link.thumb }}" mode="widthFix" />
            <text>{{ item.articleData.link.abstractText }}</text>
          </view>
        </view>

        <!-- åº•éƒ¨çš„æŒ‰é’® -->
        <view class="item-action">
          <view class="item-action-left">
            <!-- åŠ ç« -->
            <view class="icon-with-text" bindtap="toggleFire" data-id="{{ item.id }}">
              <image class="action-icon" src="/resources/home/fire-{{ item.communityData.hasFire ? 'red' : 'gray' }}.png" />
              <text class="action-text">{{ item.communityData.fireCount }}</text>
            </view>
            <!-- è¯„è®º -->
            <view class="icon-with-text" bindtap="promptUnsupported" data-text="æš‚æœªå¼€æ”¾æ­¤åŠŸèƒ½ ðŸ™ƒ">
              <image class="action-icon" src="/resources/home/comment.png" />
              <text class="action-text">{{ item.communityData.commentCount }}</text>
            </view>
          </view>
          <!-- åˆ†äº« -->
          <view class=".item-action-right">
            <button class="share-button" open-type="share" data-id="{{ item.id }}">
              <image class="share-icon" src="/resources/home/share.png" />
            </button>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>

<!--å›¾ç‰‡å¼¹æ¡†-->
<view class="popup {{ popupState }}" bindtap="hidePopup">
  <view></view>
  <image wx:if="{{ bigImageSrc }}" src="{{ bigImageSrc }}" mode="widthFix" />
  <view></view>
</view>